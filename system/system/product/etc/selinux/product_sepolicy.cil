(typeattributeset domain (adbd apexd app_zygote ashmemd audioserver blkid blkid_untrusted bluetooth bootanim bootstat bufferhubd cameraserver charger clatd crash_dump dhcp dnsmasq drmserver dumpstate e2fs ephemeral_app fastbootd fingerprintd flags_health_check fsck fsck_untrusted gatekeeperd gpuservice healthd heapprofd hwservicemanager idmap incident incident_helper incidentd init inputflinger install_recovery installd iorapd isolated_app kernel keystore llkd lmkd logd logpersist mdnsd mediadrmserver mediaextractor mediametrics mediaprovider mediaserver mediaswcodec modprobe mtp netd netutils_wrapper network_stack nfc perfetto performanced perfprofd platform_app postinstall ppp priv_app profman racoon radio recovery recovery_persist recovery_refresh rs rss_hwm_reset runas runas_app sdcardd secure_element servicemanager sgdisk shared_relro shell simpleperf_app_runner slideshow statsd su surfaceflinger system_app system_server tee tombstoned toolbox traced traced_probes traceur_app tzdatacheck ueventd uncrypt untrusted_app untrusted_app_27 untrusted_app_25 update_engine update_verifier usbd vdc vendor_init vendor_misc_writer vendor_shell virtual_touchpad vndservicemanager vold vold_prepare_subdirs vr_hwc watchdogd webview_zygote wificond wpantund zygote dataservice_app qtelephony qti-display dpmd dun-server location_app vendor_mmi_sys perfservice qspmsvc qvrd seempd sxrd vpsservice wfdservice atlasservice autochmod-sh bspCriticalLog bspFwUpdate criticallog foss horae hypnusd motorcontrol oiface oppodebugtool oppo_shell oppoasserttip oppobootloghelper oppotheme_app ousage screen_record wifi_ftm wifirftest engineer_system_daemon engineermode_app commondcs apex_test_prepostinstall art_apex_boot_integrity art_apex_postinstall art_apex_preinstall atrace auditctl blank_screen bpfloader cppreopts dex2oat dexoptanalyzer fsverity_init fwk_bufferhub gsid hal_allocator_default iw lpdumpd migrate_legacy_obb_data notify_traceur otapreopt_chroot otapreopt_slot postinstall_dexopt preloads_copy preopt2cachename stats storaged system_server_startup system_suspend viewcompiler wait_for_keymaster bt_logger sigmahal_qti chcon hans hypnus_context junklog neo oae_server omedia oppo_agingtest_app oppo_kevents oppo_theias perf_record psensord qcamera-daemon quickboot replace_splash_logo resize_ext4 rotorsrv rutilsdaemon systemhelper_app ))
(typeattributeset hwservice_manager_type (default_android_hwservice fwk_bufferhub_hwservice fwk_camera_hwservice fwk_display_hwservice fwk_scheduler_hwservice fwk_sensor_hwservice fwk_stats_hwservice hal_atrace_hwservice hal_audiocontrol_hwservice hal_audio_hwservice hal_authsecret_hwservice hal_bluetooth_hwservice hal_bootctl_hwservice hal_broadcastradio_hwservice hal_camera_hwservice hal_codec2_hwservice hal_configstore_ISurfaceFlingerConfigs hal_confirmationui_hwservice hal_contexthub_hwservice hal_drm_hwservice hal_cas_hwservice hal_dumpstate_hwservice hal_evs_hwservice hal_face_hwservice hal_fingerprint_hwservice hal_gatekeeper_hwservice hal_gnss_hwservice hal_graphics_allocator_hwservice hal_graphics_composer_hwservice hal_graphics_mapper_hwservice hal_health_hwservice hal_health_storage_hwservice hal_input_classifier_hwservice hal_ir_hwservice hal_keymaster_hwservice hal_light_hwservice hal_lowpan_hwservice hal_memtrack_hwservice hal_neuralnetworks_hwservice hal_nfc_hwservice hal_oemlock_hwservice hal_omx_hwservice hal_power_hwservice hal_power_stats_hwservice hal_renderscript_hwservice hal_secure_element_hwservice hal_sensors_hwservice hal_telephony_hwservice hal_tetheroffload_hwservice hal_thermal_hwservice hal_tv_cec_hwservice hal_tv_input_hwservice hal_usb_hwservice hal_usb_gadget_hwservice hal_vehicle_hwservice hal_vibrator_hwservice hal_vr_hwservice hal_weaver_hwservice hal_wifi_hwservice hal_wifi_hostapd_hwservice hal_wifi_offload_hwservice hal_wifi_supplicant_hwservice hidl_allocator_hwservice hidl_base_hwservice hidl_manager_hwservice hidl_memory_hwservice hidl_token_hwservice system_net_netd_hwservice system_suspend_hwservice system_wifi_keystore_hwservice thermalcallback_hwservice hal_atfwd_hwservice sigmahal_hwservice fwk_face_hwservice fwk_fingerprint_hwservice commondcs_hwservice hal_systemhelper_hwservice ))
(typeattributeset coredomain_hwservice (fwk_bufferhub_hwservice fwk_camera_hwservice fwk_display_hwservice fwk_scheduler_hwservice fwk_sensor_hwservice fwk_stats_hwservice hidl_allocator_hwservice hidl_manager_hwservice hidl_memory_hwservice hidl_token_hwservice system_net_netd_hwservice system_suspend_hwservice system_wifi_keystore_hwservice hal_atfwd_hwservice fwk_face_hwservice fwk_fingerprint_hwservice commondcs_hwservice hal_systemhelper_hwservice ))
(typeattributeset appdomain (bluetooth ephemeral_app isolated_app mediaprovider network_stack nfc platform_app priv_app radio runas_app secure_element shared_relro shell system_app traceur_app untrusted_app untrusted_app_27 untrusted_app_25 dataservice_app qtelephony location_app oppotheme_app engineermode_app oppo_agingtest_app systemhelper_app ))
(typeattributeset coredomain (adbd apexd app_zygote ashmemd audioserver blkid blkid_untrusted bluetooth bootanim bootstat bufferhubd cameraserver charger clatd crash_dump dhcp dnsmasq drmserver dumpstate e2fs ephemeral_app fastbootd fingerprintd flags_health_check fsck fsck_untrusted gatekeeperd gpuservice healthd heapprofd hwservicemanager idmap incident incident_helper incidentd init inputflinger install_recovery installd iorapd isolated_app kernel keystore llkd lmkd logd logpersist mdnsd mediadrmserver mediaextractor mediametrics mediaprovider mediaserver mediaswcodec modprobe mtp netd netutils_wrapper network_stack nfc perfetto performanced platform_app postinstall ppp priv_app profman racoon radio recovery recovery_persist recovery_refresh rs rss_hwm_reset runas runas_app sdcardd secure_element servicemanager sgdisk shared_relro shell simpleperf_app_runner slideshow statsd su surfaceflinger system_app system_server tombstoned toolbox traced traced_probes traceur_app tzdatacheck ueventd uncrypt untrusted_app untrusted_app_27 untrusted_app_25 update_engine update_verifier usbd vdc virtual_touchpad vold vold_prepare_subdirs vr_hwc watchdogd webview_zygote wificond wpantund zygote dataservice_app qtelephony dpmd dun-server vendor_mmi_sys perfservice qspmsvc qvrd seempd sxrd vpsservice wfdservice atlasservice autochmod-sh bspCriticalLog bspFwUpdate criticallog foss horae hypnusd motorcontrol oiface oppodebugtool oppo_shell oppoasserttip oppobootloghelper oppotheme_app ousage screen_record wifi_ftm wifirftest engineer_system_daemon engineermode_app commondcs apex_test_prepostinstall art_apex_boot_integrity art_apex_postinstall art_apex_preinstall atrace auditctl blank_screen bpfloader cppreopts dex2oat dexoptanalyzer fsverity_init fwk_bufferhub gsid hal_allocator_default iw lpdumpd migrate_legacy_obb_data notify_traceur otapreopt_chroot otapreopt_slot postinstall_dexopt preloads_copy preopt2cachename stats storaged system_server_startup system_suspend viewcompiler wait_for_keymaster bt_logger sigmahal_qti hans hypnus_context junklog neo oae_server omedia oppo_agingtest_app oppo_kevents oppo_theias perf_record psensord qcamera-daemon quickboot replace_splash_logo resize_ext4 rotorsrv rutilsdaemon systemhelper_app ))
(typeattribute hal_systemhelper)
(typeattribute hal_systemhelper_client)
(typeattribute hal_systemhelper_server)
(type hal_systemhelper_hwservice)
(roletype object_r hal_systemhelper_hwservice)
(type systemhelper_app)
(roletype object_r systemhelper_app)
(typetransition systemhelper_app tmpfs file appdomain_tmpfs)
(allow systemhelper_app appdomain_tmpfs (file (read write getattr map execute)))
(neverallow base_typeattr_707 base_typeattr_708 (file (ioctl read write create setattr lock relabelfrom append unlink link rename open)))
(neverallow base_typeattr_709 systemhelper_app (file (ioctl read write create setattr lock relabelfrom append unlink link rename open)))
(neverallow base_typeattr_710 systemhelper_app (process (ptrace)))
(allow hal_systemhelper_client hal_systemhelper_hwservice (hwservice_manager (find)))
(allow systemhelper_app hal_systemhelper_hwservice (hwservice_manager (add find)))
(allow systemhelper_app hidl_base_hwservice (hwservice_manager (add)))
(neverallow base_typeattr_708 hal_systemhelper_hwservice (hwservice_manager (add)))
(neverallow base_typeattr_711 hal_systemhelper_hwservice (hwservice_manager (find)))
(allow systemhelper_app surfaceflinger_service (service_manager (find)))
(allow systemhelper_app activity_service (service_manager (find)))
(allow systemhelper_app trust_service (service_manager (find)))
(allow systemhelper_app vendor_vps_service (service_manager (find)))
(allow systemhelper_app app_data_file (dir (ioctl read write getattr lock add_name remove_name search open)))
(typeattribute base_typeattr_711)
(typeattributeset base_typeattr_711 (and (domain ) (not (hal_systemhelper_client systemhelper_app ))))
(typeattribute base_typeattr_710)
(typeattributeset base_typeattr_710 (and (domain ) (not (crash_dump runas_app systemhelper_app ))))
(typeattribute base_typeattr_709)
(typeattributeset base_typeattr_709 (and (appdomain ) (not (runas_app shell systemhelper_app ))))
(typeattribute base_typeattr_708)
(typeattributeset base_typeattr_708 (and (domain ) (not (systemhelper_app ))))
(typeattribute base_typeattr_707)
(typeattributeset base_typeattr_707 (and (systemhelper_app ) (not (runas_app shell ))))
